---
title: 公交分配
permalink: /tutorials/emme/transit assignment/
---

以下，以emme的交通分配为例

## 1、EMME常见公交分配方法

Emme提供了一系列的交通任务，以评估交通政策，包括车辆容量，拥挤，票价计划，班次，时间表等，并用于模拟世界上一些最复杂的公共交通系统。Emme传输分配包括发布时可用的最快和唯一的基于多线程的基于频率的交通分配。


- **Extended Transit Assignment**多模式，多路径的交通分配，可以概括标准的交通分配（最佳策略），从而可以明确建模起点连接器的选择，对在公共站点选择交通服务的行进时间（除了行进路程）的敏感性等 。 还节省了策略并提供了复杂的分配后分析功能.
- **Congested Transit Assignment**:使用流量相关成本函数对车辆拥堵进行建模的公交分配。 link成本对运输量的依赖性可能表示由于乘客数量而导致运输车辆的速度降低，或者包括随车辆变得拥挤而增加的不舒适项的广义成本。
- **Capacitated Transit Assignment**使用连续平均法（MSA）来获得与交通路段拥堵相对应的交通流量的交通分配。 车辆拥挤功能（如在拥挤的交通分配工具中一样）以及由于过境车辆的容量而导致的停车等待时间增加被用于建模降低的舒适度水平以及停车等待时间的增加.
- **Stochastic Transit Assignment**一种随机交通分配，可计算多个基于策略的分配的平均值，其中使用选择的分配因子中的一个来干扰路段的行驶时间，感知的行进距离和/或感知因子。
- **Deterministic Transit Assignment**完整的时间表分配，其中将详细的出发和到达信息合并到最佳路径中。 它明确考虑了有关早退和迟到的选择。 对于在整个郊区和城际应用的计划时间内在不同的行程上运行的服务（例如国家或地区服务）很有用。 这对于运筹学也很有用。 尚未在Modeller中实现。 有关更多信息，请参见Emme Prompt手册4.5.9，确定性运输分配。
- **Disaggregate Transit Assignment**允许对各个过境旅行进行详细分析的分配，其中将起点和终点指定为精确的坐标或节点号，而不是区域号。 尚未在Modeller中实现。 有关更多信息，请参见《 Emme Prompt手册4.5.8，公交行程的详细分析》。
## 2、公交分配设置方法—Extended transit assignment

### 2.1、网络和需求设置——network and demand


- 可选多种transit,接驳mode如果多选，可能会出现只选最快速度的那种方式
![ta_网络设置.png](/assets/images/emme/1667286078961-c1a3553b-f87b-454b-84be-970c6ba5097d.png)


说明：mode的设置主要包括transit和aux_transit，transit为main modes,aux为辅助公交，即接驳。操作时，根据实际情况进行选择。例如：

![image.png](/assets/images/emme/1667286138553-2f44b216-3df5-45f3-b6f3-48f8503a8351.png)


### 2.2、时间和费用——Times and costs

#### 1)	等车时间——waiting time

![image.png](/assets/images/emme/1667286151950-adad0197-31b4-46d1-a881-276a2042b8dd.png)



- Source of effective headways:有效发车间隔
- Headway fraction:等车时间=发车间隔*headway fraction
- Perception factor:等车时间权重，经验值2.5
- Spread factor:扩散系数，线路分配比例，越大，分配的线路越多
#### 2）登车时间——Boarding time

![image.png](/assets/images/emme/1667286159989-64801787-e5df-405c-85e6-7e28c7c229c9.png)


登车时间的设置既可以为全局设置也可以是基于node、line、segment的设置


- 设置：惩罚参数（数值）和影响因子
#### 3）车内时间——In-vehicle time

![image.png](/assets/images/emme/1667286168135-ed726873-c112-4ce1-bf3e-2bb1ed9a1f9d.png)


可以是固定值也可以是基于link、line、transit等的某列属性

#### 4) 车内费用——In-vehicle cost:可选可不选
![image.png](/assets/images/emme/1667286183082-4ee2a26e-9e97-4bc2-a210-e429c6480356.png)



- emme的轨道站间的费用，在分配阶段无法使用站间费用矩阵，因此将轨道的费用按站间的距离，拟合的成收费曲线，因此emme中的费用可以分为上车基础票价（boarding cost）和车内费用(in vehicle cost)两部分.
基于link、line、transit等的某列属性

#### 5）辅助公交的时间和费用
![image.png](/assets/images/emme/1667286206367-c2772ae6-b4cd-428d-b702-464890da36d9.png)



- 接驳时间和接驳费用
### 3、Journey levels
![image.png](/assets/images/emme/1667286216559-f3e226aa-e6b2-484b-8ad4-f5267113be59.png)


#### 1）Transit rules：可以设置各种方式之间的换乘规则和费用
旅程等级提供了一种设施，可以根据旅行者使用的特定交通方式顺序，改变他们在旅途中所经历的一般成本。行程等级由用户定义，并允许明确建模：公交票价整合方案，例如联合模式出行的免费/折扣换乘或票价回扣例如，从可靠的交通路线信息中减少初次登机的等待时间必须使用或强制运输方式，即旅客被迫使用特定的运输方式，或多种运输方式的组合或顺序。


- 根据实际情况设置不同的journey level；
- Destination reachable表示该层是否可直达目的地；
- Next journey level的选择：
#### 2）Time and cost

### 4、起点流量分布——flow distribution at origins

#### 1) 起点流量选择：

![image.png](/assets/images/emme/1667286240645-3360a4a3-d338-481e-b6c9-a896153ef8e6.png)


流量分布：优化策略和logit分布，或者按照固定比例

### 5、辅助公交选择在regular node点的流量分布——一般默认
![image.png](/assets/images/emme/1667286252090-06c5d0cb-1215-439e-9955-61e6cf1496c1.png)


### 6、线路之间的流量分布
![image.png](/assets/images/emme/1667286264180-c82050be-e4b8-4294-ae0c-589fa217c48e.png)


### 7、连杆之间的路径禁止
![image.png](/assets/images/emme/1667286273322-09bbb3e0-d52d-495d-a971-277bf9b4f7ba.png)


### 8、circular lines——环线


- 环线线路终点全部下车
- 环线线路终点部分下车
- 部分环线终点部分下车
![image.png](/assets/images/emme/1667286285624-eb84db43-661f-4635-99c9-dec1aa4599f1.png)


### 9、结果
![image.png](/assets/images/emme/1667286924782-3d3e052c-063c-4006-a6fb-8329d31f6e5f.png)


### 10、并行设置

## 3、公交分配结果统计分析——skiming
​
### 3.1、综合阻抗


-  总阻抗与总时间 
-  实际等车时间 
- 第一次等车时间
- 实际总的等车时间
-  可以接受的等车时间 
- 可以接受的第一次等车时间
- 可以接受的总的等车时间
### 3.2、mode subset


-  Modes的选择 
- Mode的选择
- 距离矩阵
- 平均等车次数——average boardings
-  实际时间——actual times 
- 实际第一次登车时间
- 实际总的等车时间
- 实际在车时间
- 实际辅助公交时间
-  实际费用——actual cost 
- 实际第一次登车费用
- 实际总的等车费用
- 实际在车费用
- 实际辅助公交费用
-  可以接受的时间 
- 可以接受的实际第一次登车时间
- 可以接受的实际总的等车时间
- 可以接受的实际在车时间
- 可以接受的实际辅助公交时间
-  可以接受的费用 
- 可以接受的实际第一次登车费用
- 可以接受的实际总的等车费用
- 可以接受的实际在车费用
- 可以接受的实际辅助公交费用
-  并行计算设置 