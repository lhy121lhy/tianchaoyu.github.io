---
title: 数据加载
permalink: /tutorials/python/data-add/
---


## 文件路径操作：依赖包os

### 文件遍历

```python
import os
path = r'G:\'
filenames =  os.listdir(path)
for filename in filenames:
    #输出文件名
    print(filename)
    #输出完整路径
	print(os.path.join(path,filename))
```

### 判断文件是否存在


```python
if not os.path.exists("./images"):
    os.makedirs("./images")
    # 路径拼接
os.path.join(task_folder, "input/").replace("\\", "/")
```

### 文件拷贝


```python
def copy_files(input_path, output_path):
    """将一个路径的所有文件拷贝到另一个路径下"""
    for files in os.listdir(input_path):
        name = os.path.join(input_path, files)
        back_name = os.path.join(output_path, files)
        if os.path.isfile(name):
            if os.path.isfile(back_name):
                if _get_md5_(name) != _get_md5_(back_name):
                    shutil.copy(name, back_name)
                else:
                    shutil.copy(name, back_name)
                else:
                    if not os.path.isdir(back_name):
                        os.makedirs(back_name)
                        copy_files(name, back_name)
                        
                        @staticmethod
                        def _get_md5_(file_path):
                            # 通过校验MD5 判断dest内的文件与src不同
                            files_md5 = os.popen('md5 %s' % file_path).read().strip()
                            file_md5 = files_md5.replace('MD5 (%s) = ' % file_path, '')
        return file_md5
```

## 常见文件读取

### excel文件读取

#### EXCEL文件读：xlsx、xls


```python
pd.read_excel(io, sheet_name=0, header=0, names=None, index_col=None,
              usecols=None, squeeze=False,dtype=None, engine=None,
              converters=None, true_values=None, false_values=None,
              skiprows=None, nrows=None, na_values=None, parse_dates=False,
              date_parser=None, thousands=None, comment=None, skipfooter=0,
              convert_float=True, **kwds)
```

| 参数名称           | 说明 | 
|-- -|---|
| io             | 表示 Excel 文件的存储路径。 | 
| sheet_name     | 要读取的工作表名称。 | 
| header         | 指定作为列名的行，默认0，即取第一行的值为列名；若数据不包含列名，则设定 header = None。若将其设置 | 
|                | 为 header=2，则表示将前两行作为多重索引。 | 
| names          | 一般适用于Excel缺少列名，或者需要重新定义列名的情况；names的长度必须等于Excel表格列的长度，否则会报错。 | 
| index_col      | 用做行索引的列，可以是工作表的列名称，如 index_col = '列名'，也可以是整数或者列表。 | 
| usecols        | int或list类型，默认为None，表示需要读取所有列。 | 
| squeeze        | boolean，默认为False，如果解析的数据只包含一列，则返回一个Series。 | 
| converters     | 规定每一列的数据类型。 | 
| skiprows       | 接受一个列表，表示跳过指定行数的数据，从头部第一行开始。 | 
| nrows          | 需要读取的行数。 | 
| skipfooter     | 接受一个列表，省略指定行数的数据，从尾部最后一行开始。 | 

#### 写excel文件


```python
DataFrame.to_excel(excel_writer, sheet_name='Sheet1', na_rep='', float_format=None, columns=None, header=True, index=True, index_label=None, startrow=0, startcol=0, engine=None, merge_cells=True, encoding=None, inf_rep='inf', verbose=True, freeze_panes=None)
```

 | 参数名称 | 描述说明 | 
|-- -|---|
 | excel_wirter | 文件路径或者 ExcelWrite 对象。 | 
 | sheet_name | 指定要写入数据的工作表名称。 | 
 | na_rep | 缺失值的表示形式。 | 
 | float_format | 它是一个可选参数，用于格式化浮点数字符串。 | 
 | columns | 指要写入的列。 | 
 | header | 写出每一列的名称，如果给出的是字符串列表，则表示列的别名。 | 
 | index | 表示要写入的索引。 | 
 | index_label | 引用索引列的列标签。如果未指定，并且 hearder 和 index 均为为 True，则使用索引名称。如果 DataFrame | 
 |  | 使用 MultiIndex，则需要给出一个序列。 | 
 | startrow | 初始写入的行位置，默认值0。表示引用左上角的行单元格来储存 DataFrame。 | 
 | startcol | 初始写入的列位置，默认值0。表示引用左上角的列单元格来储存 DataFrame。 | 
 | engine | 它是一个可选参数，用于指定要使用的引擎，可以是 openpyxl 或 xlsxwriter。 | 

### csv文件读取


```python
# pandas.read_csv(filepath_or_buffer, sep=',', delimiter=None, header='infer',names=None, index_col=None, usecols=None)

import pandas as pd
df = pd.read_csv('file.csv',encoding="utf-8")
print(df)
# 写文件
df.to_csv("file.csv")
```
### json文件读取


```python
import pandas as pd 
data = pd.read_json('file.json')
print(data)
```

### 逐行读取大文件

```python
# 逐行读取大文件
with open('largefile.txt', 'r') as file:
    for line in file:
        process(line)  # 假设process是一个处理每行数据的函数
```